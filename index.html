<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Abrir formulario de reserva</title>
<style>
  body {
    font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    margin: 24px;
    background: #f9fafb;
  }
  .card {
    max-width: 640px;
    margin: auto;
    background: #fff;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.1);
  }
  h2 { color:#222; margin-top:0; }
  a.btn, button {
    display:inline-block;
    background:#0066cc;
    color:#fff;
    border:none;
    padding:12px 18px;
    border-radius:10px;
    text-decoration:none;
    margin:6px 0;
    cursor:pointer;
  }
  .warn {
    background:#fff7cc;
    border:1px solid #ffe08a;
    padding:10px;
    border-radius:8px;
    margin:10px 0;
  }
  .muted { color:#666; font-size:0.9em; }
</style>
</head>
<body>
<div class="card">
  <h2>Formulario de Reserva con Firma</h2>
  <p>Para que funcione correctamente, abr√≠ el formulario en el navegador de tu tel√©fono.</p>

  <div id="status" class="warn" style="display:none"></div>

  <div id="android" style="display:none">
    <p><b>Android:</b></p>
    <a id="openChrome" class="btn" href="#">Abrir en Chrome</a><br>
    <a class="btn" href="https://script.google.com/macros/s/AKfycbwSlAExsi5mF3Zgr-N3nB9QcrAaW8TktcSr-ZhOaoXGEfo8l6SsW5K8fQ5Wqp3Yhuv2/exec" target="_blank" rel="noopener">Abrir en el navegador</a><br>
  </div>

  <div id="ios" style="display:none">
    <p><b>iPhone/iPad:</b></p>
    <p>Si est√°s dentro de WhatsApp, Instagram o Gmail, toc√° <b>‚ãØ</b> y eleg√≠ <b>Abrir en Safari</b>.</p>
    <a class="btn" href="https://script.google.com/macros/s/AKfycbwSlAExsi5mF3Zgr-N3nB9QcrAaW8TktcSr-ZhOaoXGEfo8l6SsW5K8fQ5Wqp3Yhuv2/exec" target="_blank" rel="noopener">Abrir formulario</a><br>
  </div>

  <div id="desktop" style="display:none">
    <a class="btn" href="https://script.google.com/macros/s/AKfycbwSlAExsi5mF3Zgr-N3nB9QcrAaW8TktcSr-ZhOaoXGEfo8l6SsW5K8fQ5Wqp3Yhuv2/exec" target="_blank" rel="noopener">Abrir formulario</a><br>
  </div>

  <button id="copyBtn" type="button" style="display:none">üìã Copiar enlace</button>

  <p class="muted">Si no se abre, copi√° este enlace y pegalo en tu navegador:<br>
    <code>https://script.google.com/macros/s/AKfycbwSlAExsi5mF3Zgr-N3nB9QcrAaW8TktcSr-ZhOaoXGEfo8l6SsW5K8fQ5Wqp3Yhuv2/exec</code>
  </p>
</div>

<script>
const APPS_URL = 'https://script.google.com/macros/s/AKfycbwSlAExsi5mF3Zgr-N3nB9QcrAaW8TktcSr-ZhOaoXGEfo8l6SsW5K8fQ5Wqp3Yhuv2/exec';

const ua = navigator.userAgent || '';
const isAndroid = /Android/i.test(ua);
const isIOS = /iPhone|iPad|iPod/i.test(ua);
const isInApp = /(FBAN|FBAV|FB_IAB|Instagram|Gmail|Twitter|\bwv\b|WebView|Line|OkHttp)/i.test(ua);

// Mostrar vista seg√∫n dispositivo
document.getElementById(isAndroid ? 'android' : isIOS ? 'ios' : 'desktop').style.display = 'block';

// Aviso si est√° dentro de app (WhatsApp, Instagram, Gmail)
if (isInApp) {
  const s = document.getElementById('status');
  s.textContent = '‚ö†Ô∏è Est√°s usando un navegador interno (WhatsApp, Instagram o Gmail). Toc√° ‚ãÆ y eleg√≠ "Abrir en Chrome/Safari" para evitar errores.';
  s.style.display = 'block';
}

// Mostrar bot√≥n copiar
const copyBtn = document.getElementById('copyBtn');
copyBtn.style.display = 'inline-block';
copyBtn.onclick = async () => {
  try {
    await navigator.clipboard.writeText(APPS_URL);
    alert('‚úÖ Enlace copiado. Pegalo en tu navegador.');
  } catch {
    prompt('Copi√° manualmente este enlace:', APPS_URL);
  }
};

// Android: intent:// abre Chrome directamente
if (isAndroid) {
  const intent = 'intent://' + APPS_URL.replace(/^https?:\/\//,'') + '#Intent;scheme=https;package=com.android.chrome;end';
  document.getElementById('openChrome').href = intent;

  // Auto-intento de abrir en Chrome
  setTimeout(() => {
    try { window.location.href = intent; } catch (e) {}
  }, 400);
}
</script>
</body>
</html>
